define(["knockout","require"],function(a,b){"use strict";function c(){var b=this;b.places=a.observableArray().extend({deferred:!0}),b.places.subscribe(function(a){a.sort(function(a,b){return a.name<b.name?-1:a.name>b.name?1:0})}),b.searchLocation=a.observable(""),b.searchTextFilter=a.observable(""),b.suburbFilter=a.observable(""),b.setSuburbFilter=function(a,c){b.suburbFilter(a)},b.filteredPlaces=a.computed(function(){var a=[];return b.searchTextFilter(),b.places().forEach(function(c){var d=""===b.suburbFilter()||c.suburb==b.suburbFilter(),e=b.searchTextFilter().length,f=c.longName().slice(0,e).toLowerCase()==b.searchTextFilter().toLowerCase();d&&f?(a.push(c),c.marker.show()):c.marker.hide()}),a}),b.locationInput=a.observable(""),b.hideNav=a.observable(!0),b.toggleNav=function(){b.hideNav(!b.hideNav())},b.searchSubmit=function(){b.autoCompHighlightItem()?b.autoCompSelect(b.autoCompHighlightItem()):1==b.filteredPlaces().length?b.autoCompSelect(b.filteredPlaces()[0]):b.showAutoCompMenu(!1)},b.showAutoCompMenu=a.observable(!1),b.searchTextFilter.subscribe(function(a){b.autoCompHighlightItem(null),0<b.filteredPlaces().length&&b.filteredPlaces().length<10?(b.showAutoCompMenu(!0),$("body").click(function(){b.showAutoCompMenu(!1)})):b.showAutoCompMenu(!1)}),b.autoCompSelect=function(a){b.searchTextFilter(a.longName()),b.showAutoCompMenu(!1),b.selectPlace(b.filteredPlaces()[0])},b.autoCompHighlightItem=a.observable(),b.setAutoCompHighlight=function(a){b.autoCompHighlightItem(a)},b.inputKeyPress=function(a,c){switch(c.keyCode){case 13:b.searchSubmit();break;case 38:b.moveAutoCompHighlight("up");break;case 40:b.moveAutoCompHighlight("down");break;default:return!0}},b.moveAutoCompHighlight=function(a){if(!b.showAutoCompMenu())return!0;var c;return c=b.autoCompHighlightItem()?b.filteredPlaces().indexOf(b.autoCompHighlightItem()):-1,"up"==a?c--:"down"==a?c++:console.log("!! got unexpected input to moveAutoCompHighlight"),0>c?c=b.filteredPlaces().length-1:c>=b.filteredPlaces().length&&(c=0),b.autoCompHighlightItem(b.filteredPlaces()[c]),!0},b.selectPlace=function(a){a.open(),b.hideNav(!0)},b.uniqueSuburbs=a.computed(function(){var a=new Set;return b.places().forEach(function(b){a.add(b.suburb)}),Array.from(a).sort()}),b.googleFail=a.observable(!1),b.fourSqrFail=a.observable(!1),b.yelpFail=a.observable(!1)}var d=new c;return a.applyBindings(d),d});